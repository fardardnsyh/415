<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Random Numbers :: Adam&#39;s Blag</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Working through Volume 2 of TAOCP" />
<meta name="keywords" content="" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="/post/taocp-vol-2-seminumerical-algorithms/" />


  






  
  
  
  
  
  <link rel="stylesheet" href="/styles.css">







  <link rel="shortcut icon" href="/img/theme-colors/green.png">
  <link rel="apple-touch-icon" href="/img/theme-colors/green.png">



<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Random Numbers">
<meta property="og:description" content="Working through Volume 2 of TAOCP" />
<meta property="og:url" content="/post/taocp-vol-2-seminumerical-algorithms/" />
<meta property="og:site_name" content="Adam&#39;s Blag" />

  
    <meta property="og:image" content="/img/favicon/green.png">
  

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">

  <meta property="article:section" content="computer science" />


  <meta property="article:published_time" content="2019-05-08 15:30:34 -0500 CDT" />












</head>
<body class="green">


<div class="container full headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Adam&#39;s Blag
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;▾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="https://adammelnyk.ca">Contact</a></li>
        
      
      
    </ul>
  </li>
</ul>

    
    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="https://adammelnyk.ca">Contact</a></li>
        
      
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="/post/taocp-vol-2-seminumerical-algorithms/">Random Numbers</a>
  </h1>
  <div class="post-meta">
    
      <time class="post-date">
        2019-05-08 ::
        
      </time>
    
    
    
  </div>

  
    <span class="post-tags">
      
      #<a href="/tags/taocp/">taocp</a>&nbsp;
      
      #<a href="/tags/knuth/">knuth</a>&nbsp;
      
      #<a href="/tags/vol2/">vol2</a>&nbsp;
      
    </span>
  
  


  

  <div class="post-content"><div>
        <p>Random numbers from the second volume of TAOCP and experimentation with PRNGs.</p>
<p>It&rsquo;s been about nine months since I finished reading the first volume. Though it&rsquo;s likely not a surprise to many, it&rsquo;s one of the more daunting reads however, I found it to be surprisingly entertaining and well written. <a href="/post/the-art-of-computer-programming/">My summary of the experience reading through the first volume</a> was more or less my thoughts on the book, but didn&rsquo;t offer a lot in terms of the content that was covered, nor did I highlight a lot of interesting material that was gleaned from its pages – perhaps I&rsquo;ll remedy that when I have time for a second read through. Admittedly, there was quite a bit of content and I don&rsquo;t think I wanted to post a section by section summary of the volume, especially when you consider that much of the first volume was devoted to stacks, trees, linked lists, and other data structures, something familiar to most software engineers and programmers. Luckily the second volume is far less familiar territory (at least to me) and may be more interesting to write about.</p>
<h3 id="not-so-random-number-generators">Not So Random Number Generators<a href="#not-so-random-number-generators" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>Early in the volume Knuth shows how difficult it is to create a sufficiently random pseudorandom number generator. Simply adding a number of complicated steps will not yield truly random numbers. Knuth includes the following algorithm, <em>Algorithm-K</em>, to illustrate this point. You can find an excerpt of the algorithm <a href="http://www.informit.com/articles/article.aspx?p=2221790">here</a>.</p>
<h4 id="algorithm-k">Algorithm K<a href="#algorithm-k" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<p>For the purposes of demonstration I&rsquo;ve implemented the algorithm below. The steps aren&rsquo;t particularly important, but as you can see it&rsquo;s a fairly involved algorithm that looks like it might produce something random.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span><span style="color:#f92672">#</span>lang racket
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">algorithm-k</span> x)
</span></span><span style="display:flex;"><span>  (<span style="color:#a6e22e">do-algorithm-k</span> x (+ <span style="color:#ae81ff">1</span> (floor (/ x (expt <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">9</span>))))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#66d9ef">define </span>ns (<span style="color:#a6e22e">variable-reference-&gt;namespace</span> (<span style="color:#f92672">#</span>%variable-reference)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">string-&gt;procedure</span> s)
</span></span><span style="display:flex;"><span>  (<span style="color:#66d9ef">define </span>sym (string-&gt;symbol s))
</span></span><span style="display:flex;"><span>  (eval sym ns))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">do-algorithm-k</span> x iterations)
</span></span><span style="display:flex;"><span>  (<span style="color:#66d9ef">define </span>step (<span style="color:#a6e22e">string-append</span>
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;k&#34;</span>
</span></span><span style="display:flex;"><span>                (<span style="color:#a6e22e">number-&gt;string</span>
</span></span><span style="display:flex;"><span>                 (+ (modulo (floor (/ x (expt <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">8</span>))) <span style="color:#ae81ff">10</span>) <span style="color:#ae81ff">3</span>))))
</span></span><span style="display:flex;"><span>  (<span style="color:#66d9ef">if </span>(eq? iterations <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>      x
</span></span><span style="display:flex;"><span>      ((<span style="color:#a6e22e">string-&gt;procedure</span> step) x iterations)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Ensure &gt;= 5 x 10^9</span>
</span></span><span style="display:flex;"><span>(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">k3</span> x iterations)
</span></span><span style="display:flex;"><span>  (<span style="color:#66d9ef">if </span>(&gt; x <span style="color:#ae81ff">5000000000</span>)
</span></span><span style="display:flex;"><span>      (<span style="color:#a6e22e">k4</span> x iterations)
</span></span><span style="display:flex;"><span>      (<span style="color:#a6e22e">k4</span> (+ x <span style="color:#ae81ff">5000000000</span>) iterations)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Middle square</span>
</span></span><span style="display:flex;"><span>(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">k4</span> x iterations)
</span></span><span style="display:flex;"><span>  (<span style="color:#a6e22e">k5</span> (modulo (floor (/ (expt x <span style="color:#ae81ff">2</span>) (expt <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">5</span>))) (expt <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">10</span>)) iterations))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Multiply</span>
</span></span><span style="display:flex;"><span>(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">k5</span> x iterations)
</span></span><span style="display:flex;"><span>  (<span style="color:#a6e22e">k6</span> (modulo (* x <span style="color:#ae81ff">1001001001</span>) (expt <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">10</span>)) iterations))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Psuedo-complement</span>
</span></span><span style="display:flex;"><span>(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">k6</span> x iterations)
</span></span><span style="display:flex;"><span>  (<span style="color:#66d9ef">if </span>(&lt; x <span style="color:#ae81ff">100000000</span>)
</span></span><span style="display:flex;"><span>      (<span style="color:#a6e22e">k7</span> (+ x <span style="color:#ae81ff">9814055677</span>) iterations)
</span></span><span style="display:flex;"><span>      (<span style="color:#a6e22e">k7</span> (- (expt <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">10</span>) x) iterations)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Interchange halves</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; ie 1234567890 -&gt; 6789012345</span>
</span></span><span style="display:flex;"><span>(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">k7</span> x iterations)
</span></span><span style="display:flex;"><span>  (<span style="color:#a6e22e">k8</span> (<span style="color:#a6e22e">+</span>
</span></span><span style="display:flex;"><span>       (* (expt <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">5</span>) (modulo x (expt <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">5</span>)))
</span></span><span style="display:flex;"><span>       (floor (/ x (expt <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">5</span>)))) iterations))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Multiply / same as k5</span>
</span></span><span style="display:flex;"><span>(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">k8</span> x iterations)
</span></span><span style="display:flex;"><span>  (<span style="color:#a6e22e">k9</span> (modulo (* x <span style="color:#ae81ff">1001001001</span>) (expt <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">10</span>)) iterations))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Decrease digits</span>
</span></span><span style="display:flex;"><span>(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">k9</span> x iterations)
</span></span><span style="display:flex;"><span>  (<span style="color:#a6e22e">k10</span> (<span style="color:#a6e22e">sub-one</span> x <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span>) iterations))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">sub-one</span> x sum mult)
</span></span><span style="display:flex;"><span>  (<span style="color:#66d9ef">if </span>(eq? x <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>      sum
</span></span><span style="display:flex;"><span>      (<span style="color:#66d9ef">if </span>(eq? (modulo x <span style="color:#ae81ff">10</span>) <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>          (<span style="color:#a6e22e">sub-one</span> (floor (/ x <span style="color:#ae81ff">10</span>)) (+ (* (modulo x <span style="color:#ae81ff">10</span>) (expt <span style="color:#ae81ff">10</span> mult)) sum) (+ <span style="color:#ae81ff">1</span> mult))
</span></span><span style="display:flex;"><span>          (<span style="color:#a6e22e">sub-one</span> (floor (/ x <span style="color:#ae81ff">10</span>)) (+ (* (- (modulo x <span style="color:#ae81ff">10</span>) <span style="color:#ae81ff">1</span>) (expt <span style="color:#ae81ff">10</span> mult)) sum) (+ <span style="color:#ae81ff">1</span> mult)))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; 99999 modify</span>
</span></span><span style="display:flex;"><span>(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">k10</span> x iterations)
</span></span><span style="display:flex;"><span>  (<span style="color:#66d9ef">if </span>(&lt; x (expt <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>      (<span style="color:#a6e22e">k11</span> (+ (expt x <span style="color:#ae81ff">2</span>) <span style="color:#ae81ff">99999</span>) iterations)
</span></span><span style="display:flex;"><span>      (<span style="color:#a6e22e">k11</span> (- x <span style="color:#ae81ff">99999</span>) iterations)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Normalize</span>
</span></span><span style="display:flex;"><span>(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">k11</span> x iterations)
</span></span><span style="display:flex;"><span>  (<span style="color:#a6e22e">k12</span> (<span style="color:#a6e22e">go-until</span> x) iterations))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">go-until</span> x)
</span></span><span style="display:flex;"><span>  (<span style="color:#66d9ef">if </span>(&lt; x (expt <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">9</span>)) (<span style="color:#a6e22e">go-until</span> (* x <span style="color:#ae81ff">10</span>)) x))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;; Modified middle square</span>
</span></span><span style="display:flex;"><span>(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">k12</span> x iterations)
</span></span><span style="display:flex;"><span>  (<span style="color:#a6e22e">do-algorithm-k</span> (modulo (floor (* x (/ (- x <span style="color:#ae81ff">1</span>) (expt <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">5</span>)))) (expt <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">10</span>)) (- iterations <span style="color:#ae81ff">1</span>)))
</span></span></code></pre></div><p>The results however random seeming do present a problem:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>&gt; <span style="color:#f92672">(</span>algorithm-k 1<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3831577709</span>
</span></span><span style="display:flex;"><span>&gt; <span style="color:#f92672">(</span>algorithm-k 12345<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5827337884</span>
</span></span><span style="display:flex;"><span>&gt; <span style="color:#f92672">(</span>algorithm-k 6065038420<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6065038420</span>
</span></span></code></pre></div><p>The first two examples produce what one might expect, but the third produces itself. Knuth points out that the algorithm happens to degenerate to 6065038420, with the lesson being:</p>
<p><em>&ldquo;Random numbers should not be generated with a method chosen at random&rdquo;</em></p>
<p>Besides coincidentally degenerating to a seemingly random number, Algorithm K has a number of other downsides, it&rsquo;s difficult to implement and because it iterates a certain amount of times depending on the input, takes a relatively long time to produce a single random number. Somewhere inside that complexity there is a reason why the generator degenerates to 6065038420. In order to be usable we need to be able to easily prove that won&rsquo;t happen. The key take away from that is that we need this to be fast and simple.</p>
<h3 id="linear-congruential-generator">Linear Congruential Generator<a href="#linear-congruential-generator" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>The most common pseudorandom number generator (according to Knuth) is a <a href="https://en.wikipedia.org/wiki/Linear_congruential_generator">Linear congruential generator</a>, which has the following equation:</p>
<p><em>Xn + 1 = (a * Xn + c) mod m</em></p>
<p>Unlike the previous algorithm, the equation isn&rsquo;t difficult to explain; numbers for m,a, and c are chosen and set by the language or library designers (hopefully not randomly) and a seed is chosen for the first value of Xn. This being a recurrence relation, the result of each run then becomes the next seed or starting value for a subsequent run. You can see this in the code below:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span><span style="color:#f92672">#</span>lang racket
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#66d9ef">define </span>next (<span style="color:#a6e22e">current-seconds</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">my-random</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#66d9ef">set! </span>next (<span style="color:#a6e22e">modulo</span>
</span></span><span style="display:flex;"><span>              (+ (* next <span style="color:#ae81ff">6364136223846793005</span>) <span style="color:#ae81ff">1442695040888963407</span>)
</span></span><span style="display:flex;"><span>              (expt <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">64</span>)))
</span></span><span style="display:flex;"><span>  next)
</span></span></code></pre></div><p>You can see the output this produces from the racket repl here:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>&gt; <span style="color:#f92672">(</span>my-random<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">14843871667761315205</span>
</span></span><span style="display:flex;"><span>&gt; <span style="color:#f92672">(</span>my-random<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">534325907729616048</span>
</span></span><span style="display:flex;"><span>&gt; <span style="color:#f92672">(</span>my-random<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5734414832404007999</span>
</span></span></code></pre></div><p>This isn&rsquo;t how Racket generates its random numbers (it uses an implementation of the <a href="https://github.com/racket/racket/blob/5bb837661c12a9752c6a99f952c0e1b267645b33/racket/src/cs/rumble/random.ss">MRG32k3a algorithm</a>), however this method is used by other languages such as the function defined in <a href="https://sourceware.org/git/?p=glibc.git;a=blob;f=stdlib/random_r.c;hb=glibc-2.26#l362">glibc</a></p>
<h4 id="choosing-our-m-and-a-values">Choosing our <em>m</em> and <em>a</em> values<a href="#choosing-our-m-and-a-values" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<p>It&rsquo;s important to note here that the numbers used above were not chosen by random, in particular it is important to pay extra attention to the numbers we choose for <em>m</em> and <em>a</em>.</p>
<ul>
<li>our m value controls the &ldquo;period&rdquo; of the random number generator which is how long it takes for it to start repeating. ie if we should choose something such as 2, we&rsquo;ll end up producing: 0,1,0,1,0&hellip; so choosing a larger number is ideal.</li>
<li>m should also be a number that will make division quick since it is a comparatively slow operation. Knuth suggests that you use the word size of the computer ie. <em>2^64</em> or use the largest prime smaller than the word size.</li>
<li>if m is a power of 2, pick a so that a % 8 = 5. This is to ensure that we produce all m possible values and gives our generator &ldquo;high potency&rdquo;. There is a proof for this but it&rsquo;s far too long to include. In general it would seem that choosing the a value is more complicated than m but equally important as poor choices for a have historically resulted in poor generators. The rules are dependant on the values of m, and c but are too long to include and explain here. <a href="https://en.wikipedia.org/wiki/Linear_congruential_generator">The wiki entry</a> contains a more detailed explanation of the choices when it comes to choosing a.</li>
</ul>
<h3 id="why-not-both">Why not both?<a href="#why-not-both" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>The LCG is just one form of PRNG such as <a href="https://en.wikipedia.org/wiki/Xorshift">xorshift</a>, <a href="https://en.wikipedia.org/wiki/Well_equidistributed_long-period_linear">WELL</a>, or the <a href="https://en.wikipedia.org/wiki/Mersenne_Twister">Mersenne Twister</a> so, if having one random number generator produces something fairly random, would two random number generators produce something even more random? As it turns out yes, but only if applied properly otherwise you could cause issues <a href="https://medium.com/@betable/tifu-by-using-math-random-f1c308c4fd9d">like the one seen in Javascripts Math.random() library</a>. If a person is unconvinced that a random number generator is not sufficiently random, putting two generators together should in Knuth words &ldquo;convince all but the most hardened of skeptics&rdquo;. One method involves taking two generators and shuffling them together, it&rsquo;s only weakness being that it does not change the number themselves, only the sequence so this may still fail the <a href="https://www.cs.indiana.edu/~kapadia/project2/node21.html">Birthday spacings</a> test. Knuth suggest instead that we use an even simpler method by combining results from the same generator, producing 500 or so results, choosing the first 55, then throwing the rest away and repeating the process.</p>
<h2 id="statistical-tests-or-how-we-can-prove-whats-really-random">Statistical Tests Or How we can prove what&rsquo;s <em>really</em> random<a href="#statistical-tests-or-how-we-can-prove-whats-really-random" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>Once we&rsquo;ve created a random number generator, we need a way to decide if it&rsquo;s actually random or not. Knuth suggests we run a battery of tests on the generator in order to determine that it&rsquo;s satisfactorily random. He also humorously suggests that if the tests don&rsquo;t come out the way we want to try reading <a href="https://en.wikipedia.org/wiki/How_to_Lie_with_Statistics">another book</a>.</p>
<p>To thoroughly evaluate a random number generator he suggests running the following tests multiple times:</p>
<ul>
<li>Equidistribution test (Frequency Test)</li>
<li>Serial Test</li>
<li>Gap Test</li>
<li>Poker Test</li>
<li>Coupon Collectors Test</li>
<li>Permutation Test</li>
<li>Runs test</li>
<li>Maximum of t test</li>
<li>Collision test</li>
<li>Birthday Spacings test</li>
<li>Serial correlation test</li>
<li>Tests on subsequences</li>
</ul>
<p>Then analyzing them using the <a href="https://en.wikipedia.org/wiki/Chi-squared_test">chi-squared test</a> and the <a href="https://en.wikipedia.org/wiki/Kolmogorov%E2%80%93Smirnov_test">Kolmogorov–Smirnov test</a> to analyze the results of the tests.</p>
<h3 id="spectral-test">Spectral test<a href="#spectral-test" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>The most important of all the tests is the Spectral test. This test is make or break for random number generators. All good PRNG&rsquo;s will pass this test, and more importantly, bad PRNG&rsquo;s will fail. There are various examples of this online but one of the more interesting that I came across was of the RANDU generator and why it fails the spectral test can be seen <a href="https://www.youtube.com/watch?v=7wVk_XsxyNk">here</a></p>
<h3 id="why-so-many-tests">Why So Many Tests?<a href="#why-so-many-tests" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>True randomness is difficult to obtain, some might argue that it may be impossible. This is even more true because after all, we are working with computers which <em>should</em> not behave randomly. For this reason we need to determine that they are significantly random enough. To determine this we need to use thorough statistical analysis to show us in a quantifiable way, how random they are. This can be difficult and time consuming to prove as it turns some random generators will pass a few of these tests, yet completely fail others. Luckily most of the math here has been done for us, and we are unlikely to be developing our own, but there are a few notable examples where this happened to fail tests but, still seemed random such as <a href="https://en.wikipedia.org/wiki/RANDU">RANDU</a> which Knuth called &ldquo;truly horrible&rdquo;.</p>
<h3 id="running-some-tests">Running some tests<a href="#running-some-tests" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>Reading about these tests was interesting, but what would be more interesting is to run it on the two generators I had used above, as well as RANDU which is shown below. Comparing the results should highlight the differences between the generators that we expect to preform well, and those that we know will preform poorly. There are a number of random number generator testers out there but the one I used was <code>dieharder</code> based on a suite of tests called diehard. For each run I generated 1,000,0000 random numbers (algorithm k took significantly longer ~20 min) and fed it to diehard. You can see the results here:</p>
<h1 id="standard-lcg">Standard LCG<a href="#standard-lcg" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#=============================================================================#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#            dieharder version 3.31.1 Copyright 2003 Robert G. Brown          #</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#=============================================================================#</span>
</span></span><span style="display:flex;"><span>   rng_name    |           filename             |rands/second|
</span></span><span style="display:flex;"><span>     file_input|                   example.input|  6.15e+06  |
</span></span><span style="display:flex;"><span><span style="color:#75715e">#=============================================================================#</span>
</span></span><span style="display:flex;"><span>        test_name   |ntup| tsamples |psamples|  p-value |Assessment
</span></span><span style="display:flex;"><span><span style="color:#75715e">#=============================================================================#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 1 times</span>
</span></span><span style="display:flex;"><span>   diehard_birthdays|   0|       100|     100|0.72874473|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 11 times</span>
</span></span><span style="display:flex;"><span>      diehard_operm5|   0|   1000000|     100|0.00008973|   WEAK   
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 24 times</span>
</span></span><span style="display:flex;"><span>  diehard_rank_32x32|   0|     40000|     100|0.24249094|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 30 times</span>
</span></span><span style="display:flex;"><span>    diehard_rank_6x8|   0|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 32 times</span>
</span></span><span style="display:flex;"><span>   diehard_bitstream|   0|   2097152|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 53 times</span>
</span></span><span style="display:flex;"><span>        diehard_opso|   0|   2097152|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 67 times</span>
</span></span><span style="display:flex;"><span>        diehard_oqso|   0|   2097152|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 74 times</span>
</span></span><span style="display:flex;"><span>         diehard_dna|   0|   2097152|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 74 times</span>
</span></span><span style="display:flex;"><span>diehard_count_1s_str|   0|    256000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 87 times</span>
</span></span><span style="display:flex;"><span>diehard_count_1s_byt|   0|    256000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 87 times</span>
</span></span><span style="display:flex;"><span> diehard_parking_lot|   0|     12000|     100|0.33164281|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 88 times</span>
</span></span><span style="display:flex;"><span>    diehard_2dsphere|   2|      8000|     100|0.08003531|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 88 times</span>
</span></span><span style="display:flex;"><span>    diehard_3dsphere|   3|      4000|     100|0.55288986|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 111 times</span>
</span></span><span style="display:flex;"><span>     diehard_squeeze|   0|    100000|     100|0.00371770|   WEAK   
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 111 times</span>
</span></span><span style="display:flex;"><span>        diehard_sums|   0|       100|     100|0.06120371|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 112 times</span>
</span></span><span style="display:flex;"><span>        diehard_runs|   0|    100000|     100|0.35781871|  PASSED  
</span></span><span style="display:flex;"><span>        diehard_runs|   0|    100000|     100|0.07426726|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 125 times</span>
</span></span><span style="display:flex;"><span>       diehard_craps|   0|    200000|     100|0.00004611|   WEAK   
</span></span><span style="display:flex;"><span>       diehard_craps|   0|    200000|     100|0.44395534|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 325 times</span>
</span></span><span style="display:flex;"><span> marsaglia_tsang_gcd|   0|  10000000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span> marsaglia_tsang_gcd|   0|  10000000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 326 times</span>
</span></span><span style="display:flex;"><span>         sts_monobit|   1|    100000|     100|0.34446776|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 327 times</span>
</span></span><span style="display:flex;"><span>            sts_runs|   2|    100000|     100|0.34889544|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 330 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|   1|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 334 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|   2|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 340 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|   3|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 348 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|   4|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 358 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|   5|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 370 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|   6|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 384 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|   7|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 400 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|   8|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 418 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|   9|    100000|     100|0.00005693|   WEAK   
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 438 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|  10|    100000|     100|0.53597412|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 460 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|  11|    100000|     100|0.89275780|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 484 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|  12|    100000|     100|0.01596294|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 486 times</span>
</span></span><span style="display:flex;"><span>rgb_minimum_distance|   2|     10000|    1000|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 489 times</span>
</span></span><span style="display:flex;"><span>rgb_minimum_distance|   3|     10000|    1000|0.00020551|   WEAK   
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 493 times</span>
</span></span><span style="display:flex;"><span>rgb_minimum_distance|   4|     10000|    1000|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 498 times</span>
</span></span><span style="display:flex;"><span>rgb_minimum_distance|   5|     10000|    1000|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 500 times</span>
</span></span><span style="display:flex;"><span>    rgb_permutations|   2|    100000|     100|0.27181166|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 503 times</span>
</span></span><span style="display:flex;"><span>    rgb_permutations|   3|    100000|     100|0.67601712|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 507 times</span>
</span></span><span style="display:flex;"><span>    rgb_permutations|   4|    100000|     100|0.05999982|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 512 times</span>
</span></span><span style="display:flex;"><span>    rgb_permutations|   5|    100000|     100|0.16764489|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 522 times</span>
</span></span><span style="display:flex;"><span>      rgb_lagged_sum|   0|   1000000|     100|0.00003809|   WEAK   
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 542 times</span>
</span></span><span style="display:flex;"><span>      rgb_lagged_sum|   1|   1000000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 572 times</span>
</span></span><span style="display:flex;"><span>      rgb_lagged_sum|   2|   1000000|     100|0.00000015|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 612 times</span>
</span></span><span style="display:flex;"><span>      rgb_lagged_sum|   3|   1000000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 662 times</span>
</span></span><span style="display:flex;"><span>      rgb_lagged_sum|   4|   1000000|     100|0.00000000|  FAILED
</span></span></code></pre></div><h1 id="randu">RANDU<a href="#randu" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span><span style="color:#f92672">#</span>lang racket
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#66d9ef">define </span>next <span style="color:#ae81ff">1090815429</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">randu</span>)
</span></span><span style="display:flex;"><span>  (<span style="color:#66d9ef">set! </span>next (modulo (* next <span style="color:#ae81ff">65539</span>) (expt <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">31</span>)))
</span></span><span style="display:flex;"><span>  next)
</span></span></code></pre></div><!-- raw HTML omitted -->
<h1 id="algorithm-k-1">Algorithm-k<a href="#algorithm-k-1" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#=============================================================================#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#            dieharder version 3.31.1 Copyright 2003 Robert G. Brown          #</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#=============================================================================#</span>
</span></span><span style="display:flex;"><span>   rng_name    |           filename             |rands/second|
</span></span><span style="display:flex;"><span>     file_input|                    backup.input|  7.99e+06  |
</span></span><span style="display:flex;"><span><span style="color:#75715e">#=============================================================================#</span>
</span></span><span style="display:flex;"><span>        test_name   |ntup| tsamples |psamples|  p-value |Assessment
</span></span><span style="display:flex;"><span><span style="color:#75715e">#=============================================================================#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 1 times</span>
</span></span><span style="display:flex;"><span>   diehard_birthdays|   0|       100|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 11 times</span>
</span></span><span style="display:flex;"><span>      diehard_operm5|   0|   1000000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 24 times</span>
</span></span><span style="display:flex;"><span>  diehard_rank_32x32|   0|     40000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 30 times</span>
</span></span><span style="display:flex;"><span>    diehard_rank_6x8|   0|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 32 times</span>
</span></span><span style="display:flex;"><span>   diehard_bitstream|   0|   2097152|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 53 times</span>
</span></span><span style="display:flex;"><span>        diehard_opso|   0|   2097152|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 67 times</span>
</span></span><span style="display:flex;"><span>        diehard_oqso|   0|   2097152|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 74 times</span>
</span></span><span style="display:flex;"><span>         diehard_dna|   0|   2097152|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 74 times</span>
</span></span><span style="display:flex;"><span>diehard_count_1s_str|   0|    256000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 87 times</span>
</span></span><span style="display:flex;"><span>diehard_count_1s_byt|   0|    256000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 87 times</span>
</span></span><span style="display:flex;"><span> diehard_parking_lot|   0|     12000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 88 times</span>
</span></span><span style="display:flex;"><span>    diehard_2dsphere|   2|      8000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 88 times</span>
</span></span><span style="display:flex;"><span>    diehard_3dsphere|   3|      4000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 108 times</span>
</span></span><span style="display:flex;"><span>     diehard_squeeze|   0|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 108 times</span>
</span></span><span style="display:flex;"><span>        diehard_sums|   0|       100|     100|0.00000018|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 109 times</span>
</span></span><span style="display:flex;"><span>        diehard_runs|   0|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span>        diehard_runs|   0|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 123 times</span>
</span></span><span style="display:flex;"><span>       diehard_craps|   0|    200000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span>       diehard_craps|   0|    200000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 323 times</span>
</span></span><span style="display:flex;"><span> marsaglia_tsang_gcd|   0|  10000000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span> marsaglia_tsang_gcd|   0|  10000000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 324 times</span>
</span></span><span style="display:flex;"><span>         sts_monobit|   1|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 325 times</span>
</span></span><span style="display:flex;"><span>      diehard_operm5|   0|   1000000|     100|0.34393548|  PASSED  
</span></span><span style="display:flex;"><span>            sts_runs|   2|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 328 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|   1|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 332 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|   2|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 338 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|   3|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 346 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|   4|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 356 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|   5|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 368 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|   6|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 382 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|   7|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 398 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|   8|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 416 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|   9|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 436 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|  10|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 458 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|  11|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 482 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|  12|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 484 times</span>
</span></span><span style="display:flex;"><span>rgb_minimum_distance|   2|     10000|    1000|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 487 times</span>
</span></span><span style="display:flex;"><span>rgb_minimum_distance|   3|     10000|    1000|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 491 times</span>
</span></span><span style="display:flex;"><span>rgb_minimum_distance|   4|     10000|    1000|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 496 times</span>
</span></span><span style="display:flex;"><span>rgb_minimum_distance|   5|     10000|    1000|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 498 times</span>
</span></span><span style="display:flex;"><span>    rgb_permutations|   2|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 501 times</span>
</span></span><span style="display:flex;"><span>    rgb_permutations|   3|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 505 times</span>
</span></span><span style="display:flex;"><span>    rgb_permutations|   4|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 510 times</span>
</span></span><span style="display:flex;"><span>    rgb_permutations|   5|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 520 times</span>
</span></span><span style="display:flex;"><span>      rgb_lagged_sum|   0|   1000000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 540 times</span>
</span></span><span style="display:flex;"><span>      rgb_lagged_sum|   1|   1000000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 570 times</span>
</span></span><span style="display:flex;"><span>      rgb_lagged_sum|   2|   1000000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 610 times</span>
</span></span><span style="display:flex;"><span>      rgb_lagged_sum|   3|   1000000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 660 times</span>
</span></span><span style="display:flex;"><span>      rgb_lagged_sum|   4|   1000000|     100|0.00000000|  FAILED
</span></span></code></pre></div><p>There&rsquo;s already quite a bit to digest here so I didn&rsquo;t include all of the test results as the first few are enough to illustrate the differences between the three algorithms. One thing you will notice is that the standard LCG used actually failed a lot of tests. After doing a little testing and some digging it seems that dieharder will also fail these tests with its own generator with the same amount of numbers. In fact, you can really only expect good results with about 10 million or more numbers, but because diehard runs on a single cpu this would have taken a considerable amount of time to run. The comparison is really what we&rsquo;re after and from the results it&rsquo;s clear that algorithm-k is not suitable, nor is RANDU much better. I wanted to be able to see what kind of results I would see from running a much larger set so I ran one last run with 100,000,000 which shows that the lcg faired a little bit better.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#=============================================================================#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#            dieharder version 3.31.1 Copyright 2003 Robert G. Brown          #</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#=============================================================================#</span>
</span></span><span style="display:flex;"><span>   rng_name    |           filename             |rands/second|
</span></span><span style="display:flex;"><span>     file_input|                   example.input|  6.16e+06  |
</span></span><span style="display:flex;"><span><span style="color:#75715e">#=============================================================================#</span>
</span></span><span style="display:flex;"><span>        test_name   |ntup| tsamples |psamples|  p-value |Assessment
</span></span><span style="display:flex;"><span><span style="color:#75715e">#=============================================================================#</span>
</span></span><span style="display:flex;"><span>   diehard_birthdays|   0|       100|     100|0.50369944|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 1 times</span>
</span></span><span style="display:flex;"><span>      diehard_operm5|   0|   1000000|     100|0.34393548|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 2 times</span>
</span></span><span style="display:flex;"><span>  diehard_rank_32x32|   0|     40000|     100|0.76284541|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 3 times</span>
</span></span><span style="display:flex;"><span>    diehard_rank_6x8|   0|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 3 times</span>
</span></span><span style="display:flex;"><span>   diehard_bitstream|   0|   2097152|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 5 times</span>
</span></span><span style="display:flex;"><span>        diehard_opso|   0|   2097152|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 6 times</span>
</span></span><span style="display:flex;"><span>        diehard_oqso|   0|   2097152|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 7 times</span>
</span></span><span style="display:flex;"><span>         diehard_dna|   0|   2097152|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 7 times</span>
</span></span><span style="display:flex;"><span>diehard_count_1s_str|   0|    256000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 8 times</span>
</span></span><span style="display:flex;"><span>diehard_count_1s_byt|   0|    256000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 8 times</span>
</span></span><span style="display:flex;"><span> diehard_parking_lot|   0|     12000|     100|0.82658516|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 8 times</span>
</span></span><span style="display:flex;"><span>    diehard_2dsphere|   2|      8000|     100|0.48942059|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 8 times</span>
</span></span><span style="display:flex;"><span>    diehard_3dsphere|   3|      4000|     100|0.95108230|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 11 times</span>
</span></span><span style="display:flex;"><span>     diehard_squeeze|   0|    100000|     100|0.38225241|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 11 times</span>
</span></span><span style="display:flex;"><span>        diehard_sums|   0|       100|     100|0.07389024|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 11 times</span>
</span></span><span style="display:flex;"><span>        diehard_runs|   0|    100000|     100|0.69622840|  PASSED  
</span></span><span style="display:flex;"><span>        diehard_runs|   0|    100000|     100|0.74440767|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 12 times</span>
</span></span><span style="display:flex;"><span>       diehard_craps|   0|    200000|     100|0.34755313|  PASSED  
</span></span><span style="display:flex;"><span>       diehard_craps|   0|    200000|     100|0.93778967|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 32 times</span>
</span></span><span style="display:flex;"><span> marsaglia_tsang_gcd|   0|  10000000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span> marsaglia_tsang_gcd|   0|  10000000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 32 times</span>
</span></span><span style="display:flex;"><span>         sts_monobit|   1|    100000|     100|0.13113454|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 32 times</span>
</span></span><span style="display:flex;"><span>            sts_runs|   2|    100000|     100|0.22502954|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 33 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|   1|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 33 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|   2|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 34 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|   3|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 34 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|   4|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 35 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|   5|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 37 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|   6|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 38 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|   7|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span>^<span style="color:#f92672">[[</span>1;5D# The file file_input was rewound <span style="color:#ae81ff">40</span> times
</span></span><span style="display:flex;"><span>         rgb_bitdist|   8|    100000|     100|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 41 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|   9|    100000|     100|0.00048263|   WEAK   
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 43 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|  10|    100000|     100|0.00000207|   WEAK   
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 46 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|  11|    100000|     100|0.11712560|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 48 times</span>
</span></span><span style="display:flex;"><span>         rgb_bitdist|  12|    100000|     100|0.00070481|   WEAK   
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 48 times</span>
</span></span><span style="display:flex;"><span>rgb_minimum_distance|   2|     10000|    1000|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 48 times</span>
</span></span><span style="display:flex;"><span>rgb_minimum_distance|   3|     10000|    1000|0.00073621|   WEAK   
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 49 times</span>
</span></span><span style="display:flex;"><span>rgb_minimum_distance|   4|     10000|    1000|0.00000000|  FAILED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 49 times</span>
</span></span><span style="display:flex;"><span>rgb_minimum_distance|   5|     10000|    1000|0.00000148|   WEAK   
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 50 times</span>
</span></span><span style="display:flex;"><span>    rgb_permutations|   2|    100000|     100|0.64531526|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 50 times</span>
</span></span><span style="display:flex;"><span>    rgb_permutations|   3|    100000|     100|0.12491885|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 50 times</span>
</span></span><span style="display:flex;"><span>    rgb_permutations|   4|    100000|     100|0.29544943|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 51 times</span>
</span></span><span style="display:flex;"><span>    rgb_permutations|   5|    100000|     100|0.57519225|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 52 times</span>
</span></span><span style="display:flex;"><span>      rgb_lagged_sum|   0|   1000000|     100|0.42557400|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 54 times</span>
</span></span><span style="display:flex;"><span>      rgb_lagged_sum|   1|   1000000|     100|0.94028320|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 57 times</span>
</span></span><span style="display:flex;"><span>      rgb_lagged_sum|   2|   1000000|     100|0.34329913|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 61 times</span>
</span></span><span style="display:flex;"><span>      rgb_lagged_sum|   3|   1000000|     100|0.02887377|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 66 times</span>
</span></span><span style="display:flex;"><span>      rgb_lagged_sum|   4|   1000000|     100|0.02328575|  PASSED  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The file file_input was rewound 72 times</span>
</span></span><span style="display:flex;"><span>      rgb_lagged_sum|   5|   1000000|     100|0.10863760|  PASSED  
</span></span></code></pre></div><p>Here we can see the larger set actually did quite a bit better, passing where it was either weak or had even failed before. It&rsquo;s not perfect of course, and certainly not suitable for cryptographic use but we can see that the generator works well enough. I would have liked to have run more tests and tried a few different random number generators, but testing with dieharder was taking quite a long time on my underpowered laptop CPU. Of course no generator is going to pass every test as Knuth states: <em>&ldquo;A truly random sequence will exhibit local non-randomness&rdquo;</em>. Proving that a generator is suitable would require many more multiple runs on larger data sets. Only then might say that the PRNG is satisfiably random.</p>
<h2 id="not-so-random-musings">Not So Random Musings<a href="#not-so-random-musings" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>In a set of infinite numbers we might expect to see 1,000,000 7&rsquo;s or 8&rsquo;s in a row at some point. Maybe the numbers, viewed in a single line would map to ascii values that could print the works of Shakespeare. It may not be desirable for applications, but it would be consistent with a truly random number generator. Though the math was certainly beyond me, the first half of volume 2 was incredibly interesting. If anything it&rsquo;s made me question how random numbers are generated a little more, forcing me to dig through the random number generators that I have trusted. A simple mistake could result in unexpected deterministic behaviour. Though this is unlikely to be a problem in my day to day life as a web developer, it will still make me think the next time I need to rely on random behaviour. Further fueling my paranoia, Knuth gives some great advice to summarise the learnings of the chapter:</p>
<p><em>&ldquo;Look at the subroutine library of each computer installation in your organization, and replace the random number generators by good ones. Try to avoid being too shocked at what you find.&rdquo;</em></p>
      </div></div>

  
    
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h">Read other posts</span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        <span class="button previous">
            <a href="/post/building-a-cli-tool-in-rust/">
                <span class="button__icon">←</span>
                <span class="button__text">Building a Cli Tool in Rust</span>
            </a>
        </span>
        
        
        <span class="button next">
            <a href="/post/functional-programming-in-racket/">
                <span class="button__text">Functional Programming in Racket</span>
                <span class="button__icon">→</span>
            </a>
        </span>
        
    </div>
</div>

  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user">
        <span>Adam Melnyk 2020</span>
    
      <span>:: <a href="https://github.com/panr/hugo-theme-terminal" target="_blank">Theme</a> made by <a href="https://github.com/panr" target="_blank">panr</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
